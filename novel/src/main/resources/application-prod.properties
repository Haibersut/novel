# 应用基本配置
spring.application.name=novel
server.port=${SERVER_PORT:8081}
spring.main.default-time-zone=Asia/Shanghai
spring.main.allow-circular-references=true

# Actuator 健康检查配置
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when-authorized
management.health.defaults.enabled=true
management.endpoints.web.base-path=/actuator
management.server.port=${SERVER_PORT:8081}

# API 配置
api.signature.secret=import {computed} from "vue";

# Sitemap 配置
siteMap.run=${SITEMAP_RUN:false}

# 文件上传配置
spring.servlet.multipart.max-file-size=40MB
spring.servlet.multipart.max-request-size=40MB

# 定时任务线程池配置
spring.task.scheduling.pool.size=20

# 代理配置（可选）
proxy.host=${PROXY_HOST:}
proxy.port=${PROXY_PORT:7897}
proxy.client=${PROXY_CLIENT:false}

# Cloudflare R2 配置
cloudflare.r2.account-id=${CLOUDFLARE_R2_ACCOUNT_ID:}
cloudflare.r2.access-key=${CLOUDFLARE_R2_ACCESS_KEY:}
cloudflare.r2.secret-key=${CLOUDFLARE_R2_SECRET_KEY:}
cloudflare.r2.bucket-name=${CLOUDFLARE_R2_BUCKET_NAME:photo}
cloudflare.r2.region=${CLOUDFLARE_R2_REGION:auto}
cloudflare.r2.enabled=${CLOUDFLARE_R2_ENABLED:true}

# 文件上传目录配置
file.upload.temp-dir=${FILE_UPLOAD_TEMP_DIR:/home/novel/tmp/}
file.upload.storage-dir=${FILE_UPLOAD_STORAGE_DIR:/home/novel/file/}

# 数据库模式配置: single 或 dual
database.mode=${DATABASE_MODE:single}

# 主数据库配置
spring.datasource.primary.jdbc-url=${PRIMARY_DB_URL:jdbc:mariadb://localhost:3306/novel?allowPublicKeyRetrieval=true&useSSL=false&serverTimezone=UTC&connectTimeout=30000&socketTimeout=60000}
spring.datasource.primary.username=${PRIMARY_DB_USERNAME:root}
spring.datasource.primary.password=${PRIMARY_DB_PASSWORD:}
spring.datasource.primary.driver-class-name=org.mariadb.jdbc.Driver

# HikariCP 连接池配置
spring.datasource.primary.hikari.maximum-pool-size=${PRIMARY_DB_POOL_SIZE:15}
spring.datasource.primary.hikari.minimum-idle=${PRIMARY_DB_MIN_IDLE:5}
spring.datasource.primary.hikari.connection-timeout=30000
spring.datasource.primary.hikari.idle-timeout=600000
spring.datasource.primary.hikari.max-lifetime=1800000
spring.datasource.primary.hikari.connection-test-query=SELECT 1
spring.datasource.primary.hikari.pool-name=PrimaryHikariPool
spring.datasource.primary.hikari.leak-detection-threshold=60000

spring.jpa.hibernate.ddl-auto=none

# 从数据库配置
spring.datasource.secondary.jdbc-url=${SECONDARY_DB_URL:jdbc:mariadb://localhost:3306/novel?allowPublicKeyRetrieval=true&useSSL=false&serverTimezone=UTC&connectTimeout=30000&socketTimeout=60000}
spring.datasource.secondary.username=${SECONDARY_DB_USERNAME:root}
spring.datasource.secondary.password=${SECONDARY_DB_PASSWORD:}
spring.datasource.secondary.driver-class-name=org.mariadb.jdbc.Driver

# HikariCP 连接池配置
spring.datasource.secondary.hikari.maximum-pool-size=${SECONDARY_DB_POOL_SIZE:8}
spring.datasource.secondary.hikari.minimum-idle=${SECONDARY_DB_MIN_IDLE:3}
spring.datasource.secondary.hikari.connection-timeout=30000
spring.datasource.secondary.hikari.idle-timeout=600000
spring.datasource.secondary.hikari.max-lifetime=1800000
spring.datasource.secondary.hikari.connection-test-query=SELECT 1
spring.datasource.secondary.hikari.pool-name=SecondaryHikariPool
spring.datasource.secondary.hikari.leak-detection-threshold=60000

spring.secondary.jpa.hibernate.ddl-auto=none